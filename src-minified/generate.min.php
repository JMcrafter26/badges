<?php $Version='1.1.3';$maintenace=false;$maintenacePassword='password';$label='Documentation:';$message='go.jm26.net/badge-docs';$labelColor='#555555';$messageColor='#97CA00';$colorText='#ffffff';$autoFontColor=true;$imageFormat='png';$chacheLife=5;$scale=20;$resizeOutput=false;$font='./DejaVuSans.woff';if($maintenace==true&&$_GET['password']!=$maintenacePassword){header('Content-Type: image/png');readfile('https://i.imgur.com/iR3RI3Q.png');header('HTTP/1.0 503 Service Unavailable');die();}if(isset($_GET['label'])){$label=$_GET['label'];$label=htmlspecialchars($label);}if(isset($_GET['message'])){$message=$_GET['message'];$message=htmlspecialchars($message);}if(isset($_GET['format'])){$imageFormat=$_GET['format'];$imageFormat=strtolower($imageFormat);}if(isset($_GET['scale'])){$scale=$_GET['scale'];if(!is_numeric($scale)||$scale>100){$scale=20;}}if(isset($_GET['resizeoutput'])){if($_GET['resizeoutput']=='true'){$resizeOutput=true;}else{$resizeOutput=false;}}$color_brightgreen='#44cc11';$color_green='#97CA00';$color_yellowgreen='#a4a61d';$color_yellow='#dfb317';$color_orange='#fe7d37';$color_red='#e05d44';$color_lightgrey='#9f9f9f';$color_cyan='#00eaff';$color_blue='#007ec6';$color_violet='#7b16ff';$color_pink='#ff69b4';$color_grey='#555555';$color_silver='#9f9f9f';$color_success='#44cc11';$color_ok='#97CA00';$color_important='#fe7d37';$color_critical='#e05d44';$color_informational='#007ec6';$color_inactive='#9f9f9f';$color_highlight='#dbe300';if(isset($_GET['color'])&&$_GET['color']!=''){$_GET['color']=strtolower($_GET['color']);$messageColor=${'color_'.$_GET['color']};if($messageColor==''){if(preg_match('/^[a-f 0-9]{6}$/i',$_GET['color'])){$messageColor=$_GET['color'];$messageColor='#'.$messageColor;}else{$messageColor='#e05d44';}}}if(isset($_GET['fontcolor'])&&$_GET['fontcolor']!=''){$_GET['fontcolor']=strtolower($_GET['fontcolor']);$colorText=${'color_'.$_GET['fontcolor']};if($colorText==''){if(preg_match('/^[a-f 0-9]{6}$/i',$_GET['fontcolor'])){$colorText=$_GET['fontcolor'];$colorText='#'.$colorText;}else{$colorText='#ffffff';}}}if($_GET['autofontcolor']=='false'){$autoFontColor=false;}elseif($_GET['autofontcolor']=='true'){$autoFontColor=true;}$bbox=imagettfbbox((9*$scale),0,$font,$label);$labelWidth=$bbox[2]-$bbox[0];$labelWidth+=(5*$scale);$bbox=imagettfbbox((9*$scale),0,$font,$message);$messageWidth=$bbox[2]-$bbox[0];$imWidth=$labelWidth+$messageWidth+(15*$scale);$imHeight=(20*$scale);$im=imagecreatetruecolor($imWidth,$imHeight);$labelColorackground=imagecolorallocate($im,255,255,255);$colorText=imagecolorallocate($im,hexdec(substr($colorText,1,2)),hexdec(substr($colorText,3,2)),hexdec(substr($colorText,5,2)));$messageColorHex=$messageColor;$messageColor=imagecolorallocate($im,hexdec(substr($messageColor,1,2)),hexdec(substr($messageColor,3,2)),hexdec(substr($messageColor,5,2)));$labelColor=imagecolorallocate($im,hexdec(substr($labelColor,1,2)),hexdec(substr($labelColor,3,2)),hexdec(substr($labelColor,5,2)));imagefilledrectangle($im,0,0,$imWidth,$imHeight,$messageColor);imagefilledrectangle($im,0,0,$labelWidth+(5*$scale),$imHeight,$labelColor);$bbox=imagettfbbox((9*$scale),0,$font,$label);$textWidth=$bbox[2]-$bbox[0];imagettftext($im,(9*$scale),0,(5*$scale),(14*$scale),$colorText,$font,$label);if($_GET['fontcolor']==''&&$autoFontColor==true){$brightness=(hexdec(substr($messageColorHex,1,2))*0.299)+(hexdec(substr($messageColorHex,3,2))*0.587)+(hexdec(substr($messageColorHex,5,2))*0.114);if($brightness>165){$colorText=imagecolorallocate($im,0,0,0);}else{$colorText=imagecolorallocate($im,255,255,255);}}$bbox=imagettfbbox((9*$scale),0,$font,$message);$textWidth=$bbox[2]-$bbox[0];imagettftext($im,(9*$scale),0,$labelWidth+(10*$scale),(14*$scale),$colorText,$font,$message);header('Cache-Control: max-age='.$chacheLife.', public');if($resizeOutput==true){$resizedImage=imagecreatetruecolor(($imWidth/$scale),($imHeight/$scale));imagecopyresampled($resizedImage,$im,0,0,0,0,($imWidth/$scale),($imHeight/$scale),$imWidth,$imHeight);$im=$resizedImage;}if($imWidth>0&&$imHeight>0){header('HTTP/1.1 200 OK');}else{header('HTTP/1.1 400 Bad Request');}if($imageFormat=='png'){header('Content-Type: image/png');imagepng($im);}elseif($imageFormat=='jpg'){header('Content-Type: image/jpg');imagejpeg($im);}elseif($imageFormat=='gif'){header('Content-Type: image/gif');imagegif($im);}else{header('Content-Type: image/png');imagepng($im);}imagedestroy($im);$statistics=true;if($statistics){$statisticsUrl='https://test.jm26.net/api/badge/statistics.php?exp='.md5('statistics'.date('h-i-d-m-Y')).'&v='.$Version;$statistics=file_get_contents($statisticsUrl);if($statistics=='update'&&file_exists('./PLEASE-UPDATE-PHP-BADGES.txt')==false){$file=fopen('./PLEASE-UPDATE-PHP-BADGES.txt','w');fwrite($file,'A new version is available. Please update PHP Badges to the latest version. \r You can download the latest version at https://github.com/JMcrafter26/php-badges/releases/latest');fclose($file);}elseif(file_exists('./PLEASE-UPDATE-PHP-BADGES.txt')==true){unlink('./PLEASE-UPDATE-PHP-BADGES.txt');}}